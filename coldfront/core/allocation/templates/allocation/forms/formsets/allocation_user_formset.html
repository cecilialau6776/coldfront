{{ formset.management_form }}
<div class="table-responsive">
  <table class="table table-sm table-hover">
    <thead>
      <tr>
        <th>
          <input type="checkbox" class="check selectAll">
        </th>
        <th scope="col">#</th>
        <th scope="col">Username</th>
        <th scope="col">First Name</th>
        <th scope="col">Last Name</th>
        <th scope="col">Email</th>
      </tr>
    </thead>
    <tbody>
      {% for form in formset %}
        {% with user=form.user.field.queryset|first %}
          <tr>
            <td>{{ form.selected }}</td>
            <td>{{ forloop.counter }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.first_name }}</td>
            <td>{{ user.last_name }}</td>
            <td>{{ user.email }}</td>
          </tr>
        {% endwith %}
        {% for hidden_field in form.hidden_fields %}
          {{hidden_field}}
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
 $(".selectAll").on("click", function () {
     $(this)
         .parent()
         .closest("table")
         .find("input[type=checkbox]")
         .prop('checked', $(this).prop('checked'));
 });

 $("input[type=checkbox]:not(.selectAll)").on("click", function (ele) {
     $(this)
         .parent()
         .closest("table")
         .find("input[type=checkbox].selectAll")
         .prop('checked', false);
 });
</script>
